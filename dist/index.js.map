{"version":3,"file":"index.js","sources":["../node_modules/preact/jsx-runtime/dist/jsxRuntime.module.js","../src/lib/utils.ts","../src/lib/index.tsx"],"sourcesContent":["import{options as r,Fragment as e}from\"preact\";export{Fragment}from\"preact\";var t=/[\"&<]/;function n(r){if(0===r.length||!1===t.test(r))return r;for(var e=0,n=0,o=\"\",f=\"\";n<r.length;n++){switch(r.charCodeAt(n)){case 34:f=\"&quot;\";break;case 38:f=\"&amp;\";break;case 60:f=\"&lt;\";break;default:continue}n!==e&&(o+=r.slice(e,n)),o+=f,e=n+1}return n!==e&&(o+=r.slice(e,n)),o}var o=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,f=0,i=Array.isArray;function u(e,t,n,o,i,u){t||(t={});var a,c,p=t;if(\"ref\"in p)for(c in p={},t)\"ref\"==c?a=t[c]:p[c]=t[c];var l={type:e,props:p,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--f,__i:-1,__u:0,__source:i,__self:u};if(\"function\"==typeof e&&(a=e.defaultProps))for(c in a)void 0===p[c]&&(p[c]=a[c]);return r.vnode&&r.vnode(l),l}function a(r){var t=u(e,{tpl:r,exprs:[].slice.call(arguments,1)});return t.key=t.__v,t}var c={},p=/[A-Z]/g;function l(e,t){if(r.attr){var f=r.attr(e,t);if(\"string\"==typeof f)return f}if(\"ref\"===e||\"key\"===e)return\"\";if(\"style\"===e&&\"object\"==typeof t){var i=\"\";for(var u in t){var a=t[u];if(null!=a&&\"\"!==a){var l=\"-\"==u[0]?u:c[u]||(c[u]=u.replace(p,\"-$&\").toLowerCase()),_=\";\";\"number\"!=typeof a||l.startsWith(\"--\")||o.test(l)||(_=\"px;\"),i=i+l+\":\"+a+_}}return e+'=\"'+i+'\"'}return null==t||!1===t||\"function\"==typeof t||\"object\"==typeof t?\"\":!0===t?e:e+'=\"'+n(t)+'\"'}function _(r){if(null==r||\"boolean\"==typeof r||\"function\"==typeof r)return null;if(\"object\"==typeof r){if(void 0===r.constructor)return r;if(i(r)){for(var e=0;e<r.length;e++)r[e]=_(r[e]);return r}}return n(\"\"+r)}export{u as jsx,l as jsxAttr,u as jsxDEV,_ as jsxEscape,a as jsxTemplate,u as jsxs};\n//# sourceMappingURL=jsxRuntime.module.js.map\n","export const cl = (...args: (string | false | undefined | null | Record<string, unknown>)[]) => {\n  let classlist = ''\n  for (const arg of args) {\n    if (!arg) continue\n    if (typeof arg === 'string') classlist += classlist ? ' ' + arg : arg\n    else if (typeof arg === 'object') {\n      for (const key in arg) {\n        if ({}.hasOwnProperty.call(arg, key) && arg[key]) {\n          classlist += classlist ? ' ' + key : key\n        }\n      }\n    }\n  }\n  return classlist\n}\n\nexport const createRange = (node: Node, targetPosition: number) => {\n  const range = document.createRange()\n  range.selectNode(node)\n\n  const stack = [node]\n  let current\n  let pos = 0\n  while ((current = stack.pop())) {\n    if (current.nodeType === Node.TEXT_NODE) {\n      const len = current.textContent!.length\n      if (pos + len >= targetPosition) {\n        range.setStart(current, targetPosition - pos)\n        range.collapse(true)\n        return range\n      }\n      pos += len\n    } else {\n      for (let i = current.childNodes.length - 1; i >= 0; i--) stack.push(current.childNodes[i])\n    }\n  }\n  range.setStart(node, node.childNodes.length)\n  range.collapse(true)\n  return range\n}\n\nexport const setSelectionPosition = (selection: Selection, el: Node, targetPosition: number) => {\n  const range = createRange(el, targetPosition)\n  selection.removeAllRanges()\n  selection.addRange(range)\n}\n\nexport const getSelectionPosition = (selection: Selection, el: Node) => {\n  const range = selection.getRangeAt(0)\n  const preSelectionRange = range.cloneRange()\n  preSelectionRange.selectNodeContents(el)\n  preSelectionRange.setEnd(range.endContainer, range.endOffset)\n  return preSelectionRange.toString().length\n}\n","import { ReadonlySignal, useComputed, useSignal } from '@preact/signals'\nimport { JSX, RefObject, render } from 'preact'\nimport { useEffect, useRef } from 'preact/hooks'\nimport { getSelectionPosition, setSelectionPosition } from './utils'\n\nexport type HintComponentProps<T> = { value: ReadonlySignal<string>; onSelect: (value: T) => void }\n\ntype CustomHint<T> = {\n  type: 'custom'\n  component: (props: HintComponentProps<T>) => JSX.Element\n}\n\ntype ListHint<T extends Record<string, unknown>> = {\n  type: 'list'\n  item: (props: T) => JSX.Element\n  getOptions: (partialValue: string) => T[]\n}\n\ntype Hint<T> =\n  (T extends Record<string, unknown>\n    ? ListHint<T> | CustomHint<T>\n    : unknown extends T\n    ? ListHint<{}> | CustomHint<T>\n    : CustomHint<T>) & {\n      format: (value: T) => string\n      deserialize: (value: string) => T\n    }\n\nconst List = <T extends Record<string, unknown>>(props: {\n  item: (props: T) => JSX.Element\n  options: ReadonlySignal<T[]>\n  onSelect: (val: T) => void\n}) => {\n  const current = useSignal<number>(0)\n\n  useEffect(() => {\n    const handler = (e: KeyboardEvent) => {\n      if (e.key === 'ArrowUp') {\n        e.preventDefault()\n        current.value = current.value > 0 ? current.value - 1 : 0\n      } else if (e.key === 'ArrowDown') {\n        e.preventDefault()\n        current.value = current.value < props.options.value.length - 1 ? current.value + 1 : current.value\n      } else if (e.key === 'Tab' || e.key === 'Enter') {\n        e.preventDefault()\n        props.onSelect(props.options.value[current.value])\n      }\n    }\n\n    document.addEventListener('keydown', handler);\n    return () => document.removeEventListener('keydown', handler)\n  }, [])\n\n  const ref = useRef<HTMLDivElement>(null)\n\n  const scrollToIndexHack = (index: number) => {\n        \n\n    ref.current?.children[index].scrollIntoView({behavior: 'smooth'})\n    \n    return 'bubble-search__hintbox__list__item--active'\n  }\n\n  return (\n    <div ref={ref} class='bubble-search__hintbox__list'>\n      {props.options.value.map((option, i) => (\n        <div onMouseOver={() => current.value = i} class={`bubble-search__hintbox__list__item ${i === current.value ? scrollToIndexHack(i) : ''}`} onClick={(e) => {\n          e.preventDefault()\n          e.stopPropagation()\n          e.stopImmediatePropagation()\n          props.onSelect(option)\n        }}><props.item {...option} /></div>\n      ))}\n    </div>\n  )\n}\n\nexport const BubblesSearch = <T extends Record<string, unknown>>(props: {\n  hints: { [K in keyof T]: Hint<T[K]> }\n  onInput: (values: { [K in keyof T]: T[K][] } & { rowText: string }) => void\n}) => {\n  const ref = useRef<HTMLDivElement>(null)\n  const hintPosition = useSignal<{ x: number; y: number }>()\n\n  const currentHintName = useSignal<keyof T>()\n  const currentHintValue = useSignal<string>('')\n  const currentAnchor = useRef<HTMLElement>(null)\n\n  const currentHint = useComputed(() =>\n    currentHintName.value ? (props.hints[currentHintName.value] as Hint<unknown>) : undefined\n  )\n\n  useEffect(() => void ref.current?.dispatchEvent(new Event('input')), [])\n\n  const onInput = (e: JSX.TargetedInputEvent<HTMLDivElement>) => {\n    let values: Record<string, any[] | any> = {}\n\n    let html = e.currentTarget.innerText\n      .replace(/(^|\\s)([^\\s]+):([^\\s]*)/g, (_, p, k, v) => {\n        if (!Object.keys(props.hints).includes(k)) {\n\n          return _.replace(\n            /^(\\s*)([^\\s]+)(\\s*)$/,\n            (_, s, m, e) =>\n              `${' '.repeat(s.length)}<span class=\"bubble-search__textbox__bubble--invalid\" data-error=\"Unknown property '${k}'\">${m}</span>${' '.repeat(e.length)}`\n          )\n        }\n\n        const itemValue = props.hints[k].deserialize(v)\n        if (itemValue) {\n          if (k in values) {\n            values[k].push(v)\n          } else {\n            values[k] = [v]\n          }\n        }\n\n        return `<span class=\"bubble-search__textbox__bubble-space\">${p}</span><span class=\"bubble-search__textbox__bubble\"><span class=\"bubble-search__textbox__bubble__key\">${k}<span class=\"bubble-search__textbox__bubble-colon\">:</span></span><span class=\"bubble-search__textbox__bubble__value\">${v}</span></span>`\n      })\n      .replace(/\\u00A0([^\\s<>])/g, ' $1')\n      .replace(/(<\\/span>)\\s*$/, '$1\\u00A0')\n\n    const selection = document.getSelection()!\n\n    const position = selection.rangeCount && getSelectionPosition(selection, e.currentTarget)\n    e.currentTarget.innerHTML = html\n    selection.rangeCount && setSelectionPosition(selection, e.currentTarget, position)\n\n    const anchorNode = selection.anchorNode?.parentElement\n    let bubble = undefined\n\n    if (anchorNode) {\n      currentAnchor.current = anchorNode\n      if (anchorNode.className === 'bubble-search__textbox__bubble-colon') {\n        currentHintName.value = anchorNode.parentElement!.childNodes[0].textContent!\n\n        currentHintValue.value = ''\n        bubble = anchorNode.parentElement!.parentElement\n      } else if (anchorNode.className === 'bubble-search__textbox__bubble__value') {\n        currentHintName.value = anchorNode.parentElement!.childNodes[0].childNodes[0].textContent!\n        currentHintValue.value = anchorNode.textContent!\n        bubble = anchorNode.parentElement\n      } else {\n        currentHintName.value = undefined\n        currentHintValue.value = ''\n      }\n    }\n\n    if (bubble && ref.current) {\n      const bubbleRect = bubble.getBoundingClientRect()\n      const searchRect = ref.current.getBoundingClientRect()\n\n      const x = bubbleRect.x - searchRect.x\n      const y = bubbleRect.y - searchRect.y\n\n      hintPosition.value = { x, y }\n    } else {\n      hintPosition.value = undefined\n    }\n\n    values['rowText'] = html.replace(/<[^>]*>/g, \"\")\n\n    // @ts-ignore\n    props.onInput(values)\n  }\n\n\n\n  return (\n    <div class='bubble-search'>\n      <div ref={ref} class='bubble-search__textbox' contenteditable spellcheck={false} onInput={onInput}>\n      </div>\n      <Hint textboxRef={ref} anchor={currentAnchor} position={hintPosition} hint={currentHint} closeHint={() => currentHintName.value = undefined} partialValue={currentHintValue} />\n    </div>\n  )\n}\n\nconst Hint = <T extends unknown>(props: {\n  position: ReadonlySignal<{ x: number; y: number } | undefined>\n  hint: ReadonlySignal<Hint<T> | undefined>\n  closeHint: () => void\n  partialValue: ReadonlySignal<string>\n  anchor: RefObject<HTMLElement>\n  textboxRef: RefObject<HTMLElement>\n}) => {\n  if (!props.hint.value) return null\n\n  const options = useComputed(() => {\n    if (!props.hint.value || props.hint.value.type === 'custom') return []\n    return props.hint.value.getOptions(props.partialValue.value)\n  })\n\n  const style = useComputed(\n    () => props.position.value && `transform: translate(${props.position.value.x}px, 10px)`// `transform: translate(${props.position.value.x}px, ${props.position.value.y}px)`\n  )\n  return (\n    <div class='bubble-search__hintbox' style={style}>\n      {props.hint.value.type === 'custom' ? (\n        <props.hint.value.component\n          value={props.partialValue}\n          onSelect={selectedValueObject => {\n            if (props.hint.value && props.hint.value.type === 'custom') {         \n              replaceWithHint({\n                currentBubbleAnchor: props.anchor,\n                textInputAnchor: props.textboxRef,\n                rowValue: props.hint.value.format(selectedValueObject as any)\n              })\n              props.closeHint()\n            }\n          }}\n        />\n      ) : (\n        <List item={props.hint.value.item} options={options} onSelect={selectedValueObject => {\n          if (props.hint.value && props.hint.value.type === 'list') {\n            replaceWithHint({\n              currentBubbleAnchor: props.anchor,\n              textInputAnchor: props.textboxRef,\n              rowValue: props.hint.value.format(selectedValueObject as any)\n            })\n          }\n          props.closeHint()\n        }} />\n      )}\n    </div>\n  )\n}\n\nconst replaceWithHint = ({ currentBubbleAnchor, textInputAnchor, rowValue }: {\n  rowValue: string,\n  currentBubbleAnchor: RefObject<HTMLElement>\n  textInputAnchor: RefObject<HTMLElement>\n\n}) => {\n  if (currentBubbleAnchor.current) {\n    let valueSpan = undefined\n\n    if (currentBubbleAnchor.current.classList.contains('bubble-search__textbox__bubble__value')) {\n      valueSpan = currentBubbleAnchor.current\n    } else if (currentBubbleAnchor.current.classList.contains('bubble-search__textbox__bubble-colon')) {\n      valueSpan = currentBubbleAnchor.current.parentElement?.nextElementSibling\n    }\n\n    if (!valueSpan) return\n\n    const selection = document.getSelection()!\n    const position = selection.rangeCount && getSelectionPosition(selection, textInputAnchor.current!)\n    const startLength = valueSpan.innerHTML.length\n    valueSpan.innerHTML = rowValue\n    selection.rangeCount && setSelectionPosition(selection, textInputAnchor.current!, position + rowValue.length - startLength + 1)\n\n    const eventTrigger = new Event('input')\n    textInputAnchor.current?.dispatchEvent(eventTrigger)\n\n  }\n}\n\nBubblesSearch.mount = <T extends Record<string, unknown>>(\n  selector: string,\n  props: {\n    hints: { [K in keyof T]: Hint<T[K]> }\n    onInput: (values: { [K in keyof T]: T[K][] } & { rowText: string }) => void\n  }\n) => render(<BubblesSearch {...props} />, document.querySelector(selector)!)\n"],"names":["f","u","n","o","i","a","c","p","l","r","createRange","node","targetPosition","range","stack","current","pos","len","setSelectionPosition","selection","el","getSelectionPosition","preSelectionRange","List","props","useSignal","useEffect","handler","e","ref","useRef","scrollToIndexHack","index","jsx","option","BubblesSearch","hintPosition","currentHintName","currentHintValue","currentAnchor","currentHint","useComputed","jsxs","values","html","_","k","s","m","position","anchorNode","bubble","bubbleRect","searchRect","x","y","Hint","options","style","selectedValueObject","replaceWithHint","currentBubbleAnchor","textInputAnchor","rowValue","valueSpan","startLength","eventTrigger","selector","render"],"mappings":"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","x_google_ignoreList":[0]}